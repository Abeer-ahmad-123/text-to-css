<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="index.css" />
    <title>Document</title>
  </head>
  <body>
    <div id="myDiv" contenteditable="true"></div>
    <div class="inputWrapper"><input id="input" /></div>
    <div id="wordCount">Word count here</div>
    <div class="colorWrapper">
      <div id="colorName"></div>
      <div id="color"></div>
    </div>

    <div class="fontSizeWrapper">
      <div id="font"></div>
      <div id="fontSize"></div>
    </div>
    <div class="backgroundWrapper">
      <div id="background"></div>

      <div id="backgroundColor"></div>
    </div>
    <div class="fontFamilyWrapper">
      <div id="fontFamilyName"></div>
      <div id="fontFamily"></div>
    </div>
  </body>
  <script>
    console.log('Checking paste operation.');
    document.addEventListener('paste', function (e) {
      //empty all div
      emptyDiv();

      console.log('The Past is Happens');
      console.log(e.clipboardData.types);
      ['text/plain', 'text/html'].forEach((format) => {
        console.log(`Format: ${format}`);
        const input = e.clipboardData.getData(format);
        document.getElementById('wordCount').innerHTML =
          'Word Count: ' + input.length;

        let styleSubStr = 'style="';
        let styleEndStr = '">';
        let styleStartIndexes = [];
        let styleEndIndexes = [];
        let styleArray2 = [];
        let startindex;
        let endIndex;
        let i = 0;
        let colorArray = [];
        let fontSizeArray = [];
        let backgroundArray = [];
        let fontFamilyArray = [];

        let newArray2;
        while (i < input.length) {
          let index = input.indexOf(styleSubStr, i);
          let endIndex = input.indexOf(styleEndStr, i);
          if (index === -1) break;
          if (endIndex === -1) break;
          styleStartIndexes.push(index + 7);
          styleEndIndexes.push(endIndex);
          i = index + styleSubStr.length;
          i = endIndex + styleSubStr.length;
        }

        var newArray = styleStartIndexes.map(function (value, index) {
          return styleStartIndexes[index] + ',' + styleEndIndexes[index];
        });
        for (var k = 0; k < newArray.length; k++) {
          const val = newArray[k].split(',');
          styleArray2 = input.substring(val[0], val[1]);
          let replaceQuot = styleArray2.replaceAll('&quot;', '');
          let replaceMonoQuot = replaceQuot.replaceAll('Mono&quot;', '');
          let replaceVar = replaceMonoQuot.replaceAll('var(--bs-font', '');
          let replaceAllBrackets = replaceVar.replaceAll(')', '');
          const mapVal = replaceAllBrackets.split(';');
          for (var j = 0; j < mapVal.length; j++) {
            let result = mapVal[j].replace('&quot', '');
            if (mapVal[j].includes('color')) {
              if (!mapVal[j].includes('-')) {
                colorArray.push(mapVal[j].split(':')[1]);
              }
            }
            if (mapVal[j].includes('font-size')) {
              fontSizeArray.push(mapVal[j].split(':')[1]);
            }

            if (mapVal[j].includes('background-color')) {
              backgroundArray.push(mapVal[j].split(':')[1]);
            }

            if (mapVal[j].includes('font-family')) {
              fontFamilyArray.push(mapVal[j].split(':')[1]);
            }
          }
        }
        let uniqueArray = [...new Set(colorArray)];
        let fontSizeUniqueArray = [...new Set(fontSizeArray)];
        let backgroundColorUniqueArray = [...new Set(backgroundArray)];
        let fontFamilyUniqueArray = [...new Set(fontFamilyArray)];

        document.getElementById('background').innerHTML = 'Background Color: ';
        if (backgroundColorUniqueArray.length === 0) {
          // // Create an "li" node:
          // const node = document.createElement('li');
          // const textnode = document.createTextNode('No Background Color Found');
          // // Append the text node to the "li" node:
          // node.appendChild(textnode);
          // node.style.listStyle = 'none';

          // document.getElementById('backgroundColor').appendChild(node);
          arrayIsEmpty('No Background Color Found', 'backgroundColor');
        } else {
          for (let a = 0; a < backgroundColorUniqueArray.length; a++) {
            // Create an "li" node:
            const node = document.createElement('li');
            node.style.background = backgroundColorUniqueArray[a];
            node.style.listStyle = 'none';
            node.style.width = '20px';
            node.style.height = '20px';
            node.style.borderRadius = '30%';
            node.style.border = '1.5px solid black';
            replaceInnerText(
              'No Background Color Found',
              'backgroundColor',
              node
            );

            // if (
            //   document.getElementById('backgroundColor').innerText ===
            //   'No Background Color Found'
            // ) {
            //   document.getElementById('backgroundColor').innerText = '';
            //   document.getElementById('backgroundColor').appendChild(node);
            // } else {
            //   document.getElementById('backgroundColor').appendChild(node);
            // }
          }
        }

        document.getElementById('font').innerHTML = 'Font Size: ';

        if (fontSizeUniqueArray.length === 0) {
          // // Create an "li" node:
          // const node = document.createElement('li');
          // const textnode = document.createTextNode('No Font Size Found');
          // // Append the text node to the "li" node:
          // node.appendChild(textnode);
          // node.style.listStyle = 'none';

          // document.getElementById('fontSize').appendChild(node);
          arrayIsEmpty('No Font Size Found', 'fontSize');
        } else {
          for (let a = 0; a < fontSizeUniqueArray.length; a++) {
            // Create an "li" node:
            const node = document.createElement('li');
            const textnode = document.createTextNode(fontSizeUniqueArray[a]);
            // Append the text node to the "li" node:
            node.appendChild(textnode);
            node.style.listStyle = 'none';
            node.style.marginRight = '10px';
            replaceInnerText('No Font Size Found', 'fontSize', node);

            // if (
            //   document.getElementById('fontSize').innerText ===
            //   'No Font Size Found'
            // ) {
            //   document.getElementById('fontSize').innerText = '';
            //   document.getElementById('fontSize').appendChild(node);
            // } else {
            //   document.getElementById('fontSize').appendChild(node);
            // }
          }
        }
        document.getElementById('fontFamilyName').innerHTML = 'Font Family: ';
        if (fontFamilyUniqueArray.length === 0) {
          // // Create an "li" node:
          // const node = document.createElement('li');
          // const textnode = document.createTextNode('No Font Family Found');
          // // Append the text node to the "li" node:
          // node.appendChild(textnode);
          // node.style.listStyle = 'none';

          // document.getElementById('fontFamily').appendChild(node);
          arrayIsEmpty('No Font Family Found', 'fontFamily');
        } else {
          for (let a = 0; a < fontFamilyUniqueArray.length; a++) {
            // Create an "li" node:
            const node = document.createElement('li');
            const textnode = document.createTextNode(fontFamilyUniqueArray[a]);
            // Append the text node to the "li" node:
            node.appendChild(textnode);
            node.style.listStyle = 'none';
            replaceInnerText('No Font Family Found', 'fontFamily', node);

            // if (
            //   document.getElementById('fontFamily').innerText ===
            //   'No Font Family Found'
            // ) {
            //   document.getElementById('fontFamily').innerText = '';
            //   document.getElementById('fontFamily').appendChild(node);
            // } else {
            //   document.getElementById('fontFamily').appendChild(node);
            // }
          }
        }
        document.getElementById('colorName').innerHTML = 'Colors: ';
        if (uniqueArray.length === 0) {
          // // Create an "li" node:
          // const node = document.createElement('li');
          // const textnode = document.createTextNode('No Colors Found');
          // // Append the text node to the "li" node:
          // node.appendChild(textnode);
          // node.style.listStyle = 'none';
          // document.getElementById('color').appendChild(node);
          arrayIsEmpty('No Colors Found', 'color');
        } else {
          for (let a = 0; a < uniqueArray.length; a++) {
            // Create an "li" node:
            const node = document.createElement('li');
            node.style.background = uniqueArray[a];
            node.style.marginRight = '10px';
            node.style.listStyle = 'none';
            node.style.width = '20px';
            node.style.height = '20px';
            node.style.borderRadius = '30%';
            node.style.border = '1.5px solid black';

            // if (
            //   document.getElementById('color').innerText === 'No Colors Found'
            // ) {
            //   document.getElementById('color').innerText = '';
            //   document.getElementById('color').appendChild(node);
            // } else {
            //   document.getElementById('color').appendChild(node);
            // }
            replaceInnerText('No Colors Found', 'color', node);
          }
        }
      });
    });
    function emptyDiv() {
      document.getElementById('wordCount').innerHTML = 'Word Count Here';
      document.getElementById('colorName').innerHTML = '';
      document.getElementById('color').innerHTML = '';
      document.getElementById('font').innerHTML = '';
      document.getElementById('fontSize').innerHTML = '';
      document.getElementById('background').innerHTML = '';
      document.getElementById('backgroundColor').innerHTML = '';
      document.getElementById('fontFamilyName').innerHTML = '';
      document.getElementById('fontFamily').innerHTML = '';
    }
    function replaceInnerText(text, id, node) {
      if (document.getElementById(id).innerText === text) {
        document.getElementById(id).innerText = '';
        document.getElementById(id).appendChild(node);
      } else {
        document.getElementById(id).appendChild(node);
      }
    }
    function arrayIsEmpty(text, id) {
      // Create an "li" node:
      const node = document.createElement('li');
      const textnode = document.createTextNode(text);
      // Append the text node to the "li" node:
      node.appendChild(textnode);
      node.style.listStyle = 'none';

      document.getElementById(id).appendChild(node);
    }
  </script>
</html>
